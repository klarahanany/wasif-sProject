<%- include('partials/header'); -%>

    <main>
        <h2>Your Cart</h2>
        <ul class="cartContent">
            <% if (cartItems.length===0) { %>
                <p>Your cart is empty.</p>
                <% } else { %>
                    <% cartItems.forEach((item)=> { %>
                        <li class="cartItem">
                            <span>
                                <%= item.name %>
                            </span>
                            <span>
                                <%= item.price %>
                            </span>
                            <br>
                            <input type="number" id="quantity" name="quantity" min="1" value=<%=item.quantity %>
                            required>
                            <button class="DeleteFromCart" onclick="removeItem( '<%= item.name %>')">Delete</button>
                            <!-- Add functionality to remove items from the cart -->
                        </li>
                        <% }); %>
                            <hr>
                            <p class="total">Total: <%= total %>
                            </p>
                            <button>Checkout</button>

                            <% } %>
        </ul>
    </main>

    <%- include('partials/footer'); -%>

        <script>

            const cartItems = [
                {
                    id: 1,
                    name: 'Spiritual Tea',
                    description: 'A calming and soothing tea for mindfulness.',
                    quantity: 2,

                    price: 5.99
                },
                {
                    id: 2,
                    name: 'Meditation Coffee',
                    description: 'Awaken your senses with our meditation coffee blend.',
                    quantity: 2,
                    price: 4.99
                },
                {
                    id: 3,
                    name: 'Zen Juice',
                    description: 'A refreshing juice that brings inner peace.',
                    quantity: 2,
                    price: 3.49
                }
            ];
            function removeItem(nameItem) {
                // Find the index of the item to be removed in the cartItems array
                const itemIndex = cartItems.findIndex(item => item.name === nameItem);
                // If the item was found in the cartItems array, remove it
                if (itemIndex !== -1) {
                    cartItems.splice(itemIndex, 1);
                }
                // Re-render the cart to reflect the updated cartItems
                renderCart();
            }
            // Function to render the cart after an item is removed
            function renderCart() {
                // Select the <ul> element in your HTML where cart items are displayed
                const cartList = document.querySelector('.cartContent');

                // Clear the cart items currently displayed
                cartList.innerHTML = '';

                // Iterate through the updated cartItems and re-render them
                if (cartItems.length === 0) {
                    const p = document.createElement('p');
                    p.textContent = "Your cart is empty."
                    cartList.appendChild(p)
                }
                else {
                    cartItems.forEach(item => {
                        const listItem = document.createElement('li');
                        listItem.className = "cartItem"
                        listItem.innerHTML = `
                        <span>${item.name}</span>
                        <span>$${item.price}</span>
                        <input type="number" id="quantity" name="quantity" min="1" value=${item.quantity}
                            required>
                        <button onclick="removeItem('${item.name}')">Delete</button>
                         `;
                        cartList.appendChild(listItem);
                    });
                    const hr = document.createElement('hr');
                    const p = document.createElement('p');
                    p.className = "total"
                    p.textContent = calculateTotal();
                    const checkout = document.createElement('button');
                    checkout.textContent = "Checkout"
                    cartList.appendChild(hr)
                    cartList.appendChild(p)
                    cartList.appendChild(checkout)
                    // Update the total price if needed
                    const totalElement = document.querySelector('.total');
                    totalElement.textContent = `Total: $${calculateTotal(cartItems)}`;
                }

            }

            // // Add an event listener to the "Checkout" button (you can implement checkout functionality here)
            // const checkoutButton = document.querySelector('button');
            // checkoutButton.addEventListener('click', () => {
            //     // Implement checkout logic here (e.g., send cart data to the server for processing)
            // });



            // Function to calculate the total price of items in the cart
            function calculateTotal() {
                return cartItems.reduce((total, item) => total + item.price * item.quantity, 0);
            }

            // Initial rendering of the cart
            // renderCart();

        </script>